<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: work | 我是清都山水郎]]></title>
  <link href="http://hopes4.me/blog/categories/work/atom.xml" rel="self"/>
  <link href="http://hopes4.me/"/>
  <updated>2013-01-29T13:50:36+08:00</updated>
  <id>http://hopes4.me/</id>
  <author>
    <name><![CDATA[sleepy]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[linux上自动重启tomcat的脚本]]></title>
    <link href="http://hopes4.me/blog/auto-restart-tomcat/"/>
    <updated>2013-01-21T10:15:00+08:00</updated>
    <id>http://hopes4.me/blog/auto-restart-tomcat</id>
    <content type="html"><![CDATA[<p>这两天正在做的一个项目，tomcat老是会无故自己停掉，而且没有报错信息所以也无从修复。无奈之下，只能想是不是可以用定时脚本去监测tomcat是不是还在运行，然后重启tomcat。</p>

<p>经过网上搜索别人博客上贴出的脚本，根据自己服务的情况进行了一下修改，下面贴出脚本：</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>自动重启tomcat脚本 </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>echo ========================================
</span><span class='line'>date
</span><span class='line'>cd /root/script
</span><span class='line'>rm -f index.html
</span><span class='line'>wget -T 10 -t 3 -q http://127.0.0.1:8080/
</span><span class='line'>if [ ! -e index.html ]; then
</span><span class='line'>export JAVA_HOME=/usr/java/jdk1.6.0_38
</span><span class='line'>export CLASSPATH=.:$JAVA_HOME/lib/tools.jar
</span><span class='line'>export CATALINA_HOME=/usr/local/tomcat
</span><span class='line'>export PATH=$JAVA_HOME/bin:$PATH&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>echo "restart tomcat."
</span><span class='line'>${CATALINA_HOME}/bin/shutdown.sh
</span><span class='line'>sleep 150
</span><span class='line'>kill -9 &lt;code>ps aux|grep java|grep -v grep|awk '{print $2}'&lt;/code>
</span><span class='line'>sleep 5
</span><span class='line'>${CATALINA_HOME}/bin/startup.sh
</span><span class='line'>sleep 5
</span><span class='line'>else
</span><span class='line'>echo "checked."
</span><span class='line'>fi&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p></span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>经过本人的测试，应该是没什么问题，也总算是暂时解决了这个问题。</p>
]]></content>
  </entry>
  
</feed>
